+++
date = '2025-07-27T19:45:10+08:00'
draft = false
title = 'Rust学习——变量与它的可变性'
categories = ['学习']
tags = ['Rust']
+++

每天学习一点 Rust 知识，今天主要看一下 Rust 中的变量和它的可变性，主要介绍一下 `let`、`let mut`、`const` 和 shadowing 的概念。

**let 声明变量**

Rust 中的变量默认是不允许更改的，例如下面的代码会编译错误：

```rust
let x = 5;
x = 6;
```

因为 `let x = 5;` 声明的x默认是不允许改变，如果想让其发生变化则需要使用 `mut` 关键字。

```rust
let mut x = 5;
x = 6;
```

**const 定义常量**

```rust
const THREE_HOURS_IN_SECONDS: u32 = 60 * 60 * 3;	// 3 小时秒数
```

Rust 中使用 const 关键字定义常量，常量同样也是不可以改变的值，它和普通变量的区别是它不可以和 mut 关键字一起使用，而且必须被注释，也就是说常量一旦定义，整个程序的生命周期内它是不可以改变的。

而且常量只能设置为常量表达式，它不可以在程序运行过程中定义。这和大多数其他语言（C、C++、Java等）相同。就不做过多介绍。

**Shadowing**

它的含义可以理解为覆盖，算是 Rust 中的一个特别的操作，例如下面的代码：

```rust
let x = 5;	// 定义变量 x 为5
let x = 5 + 1;	// 定义同名为 x 的变量，在上面 x 的基础上加1
{
  let x = x * 2;	// 在这个作用域中重新定义 x 变量为 x * 2;
  // 该作用域下 x 为12
}
// 此时 x 为6
```

上面这种可以覆盖同名变量的操作就被称为 shadowing

需要注意的一点是 shadowing 操作后的变量数据类型会根据最新的表达式重新推断，而如果使用 mut 这种可变变量的话数据类型以第一次 let 声明时为准。

编译正确代码：

```rust
let spaces = "      ";	// 6 个空格，此时是字符串类型
let spaces = spaces.len();	// 计算上面 spaces 的长度，此时数据类型为数字
```

编译的代码

```rust
let mut spaces = "      "; // 6 个空格的可变变量
spaces = space.len();	// 编译报错
```


